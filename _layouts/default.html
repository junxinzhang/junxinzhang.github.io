<!DOCTYPE html>
{% include i18n.html %}
{% assign lang_code_map = "en:en,zh-hans:zh-CN,zh-hant:zh-TW,ja:ja,ko:ko,de:de,fr:fr,it:it,es:es,pt:pt,hi:hi" | split: "," %}
{% assign html_lang = "zh-CN" %}
{% for mapping in lang_code_map %}
    {% assign parts = mapping | split: ":" %}
    {% if parts[0] == current_lang %}
        {% assign html_lang = parts[1] %}
    {% endif %}
{% endfor %}
<html lang="{{ html_lang }}">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>{{page.title}} | {{site.name}}</title>

    {% seo %}

    <!-- Schema.org structured data for SEO & GEO -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "{% if page.layout == 'post' %}BlogPosting{% else %}WebSite{% endif %}",
      "name": "{{ site.name }}",
      "url": "{{ site.url }}{{ page.url }}",
      "inLanguage": "{{ html_lang }}",
      {% if page.layout == 'post' %}
      "headline": "{{ page.title | escape }}",
      "datePublished": "{{ page.date | date_to_xmlschema }}",
      "dateModified": "{% if page.last_modified_at %}{{ page.last_modified_at | date_to_xmlschema }}{% else %}{{ page.date | date_to_xmlschema }}{% endif %}",
      "author": {
        "@type": "Person",
        "name": "{{ site.authors[page.author].name | default: 'Jason Zhang' }}",
        "url": "{{ site.url }}/about.html",
        "jobTitle": "{{ site.authors[page.author].job_title | default: 'AI 技术专家 & DevOps 架构师' }}",
        "description": "{{ site.authors[page.author].bio | default: '专注于 AI 私有化部署、DevOps、云原生架构' }}"
      },
      "publisher": {
        "@type": "Organization",
        "name": "{{ site.name }}",
        "logo": {
          "@type": "ImageObject",
          "url": "{{ site.url }}/{{ site.logo }}"
        }
      },
      {% if page.image %}
      "image": "{% if page.image contains '://' %}{{ page.image }}{% else %}{{ site.url }}/{{ page.image }}{% endif %}",
      {% endif %}
      "description": "{% if page.description %}{{ page.description | escape }}{% else %}{{ page.excerpt | strip_html | strip_newlines | truncate: 160 | escape }}{% endif %}",
      "keywords": "{{ page.tags | join: ', ' }}",
      "articleSection": "{{ page.categories | first }}"
      {% else %}
      "description": "{{ site.description | escape }}",
      "author": {
        "@type": "Person",
        "name": "Jason Zhang",
        "url": "{{ site.url }}/about.html"
      },
      "potentialAction": {
        "@type": "SearchAction",
        "target": "{{ site.url }}/?s={search_term_string}",
        "query-input": "required name=search_term_string"
      }
      {% endif %}
    }
    </script>

    <!-- BreadcrumbList Schema for better navigation in AI search -->
    {% if page.layout == 'post' %}
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "BreadcrumbList",
      "itemListElement": [
        {
          "@type": "ListItem",
          "position": 1,
          "name": "{{ site.name }}",
          "item": "{{ site.url }}"
        },
        {% if page.categories.size > 0 %}
        {
          "@type": "ListItem",
          "position": 2,
          "name": "{{ page.categories | first }}",
          "item": "{{ site.url }}/categories.html#{{ page.categories | first | downcase }}"
        },
        {
          "@type": "ListItem",
          "position": 3,
          "name": "{{ page.title | escape }}",
          "item": "{{ site.url }}{{ page.url }}"
        }
        {% else %}
        {
          "@type": "ListItem",
          "position": 2,
          "name": "{{ page.title | escape }}",
          "item": "{{ site.url }}{{ page.url }}"
        }
        {% endif %}
      ]
    }
    </script>
    {% endif %}

    <!-- FAQ Schema for GEO optimization -->
    {% if page.faq %}
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "FAQPage",
      "mainEntity": [
        {% for item in page.faq %}
        {
          "@type": "Question",
          "name": "{{ item.question | escape }}",
          "acceptedAnswer": {
            "@type": "Answer",
            "text": "{{ item.answer | escape }}"
          }
        }{% unless forloop.last %},{% endunless %}
        {% endfor %}
      ]
    }
    </script>
    {% endif %}

    <!-- HowTo Schema for tutorial/guide posts -->
    {% if page.howto %}
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "HowTo",
      "name": "{{ page.howto.name | default: page.title | escape }}",
      "description": "{{ page.howto.description | default: page.description | escape }}",
      {% if page.howto.totalTime %}"totalTime": "{{ page.howto.totalTime }}",{% endif %}
      {% if page.image %}"image": "{% if page.image contains '://' %}{{ page.image }}{% else %}{{ site.url }}/{{ page.image }}{% endif %}",{% endif %}
      "step": [
        {% for step in page.howto.steps %}
        {
          "@type": "HowToStep",
          "position": {{ forloop.index }},
          "name": "{{ step.name | escape }}",
          "text": "{{ step.text | escape }}"
        }{% unless forloop.last %},{% endunless %}
        {% endfor %}
      ]
    }
    </script>
    {% endif %}

    <link rel="shortcut icon" type="image/x-icon" href="{{site.baseurl}}/{{site.favicon}}">
    <link rel="apple-touch-icon" sizes="180x180" href="{{site.baseurl}}/assets/images/favicon/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="{{site.baseurl}}/assets/images/favicon/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="{{site.baseurl}}/assets/images/favicon/favicon-16x16.png">

    <!-- Font Awesome Icons -->
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.3.1/css/all.css" integrity="sha384-mzrmE5qonljUremFsqc01SB46JvROS7bZs3IO2EmfFsd15uHvIt+Y8vEf7N7fWAU" crossorigin="anonymous">

    <!-- Google Fonts-->
    <link href="https://fonts.googleapis.com/css?family=Lora:400,400i,700" rel="stylesheet">

    <!-- Bootstrap Modified -->
    <link rel="stylesheet" href="{{site.baseurl}}/assets/css/main.css">

    <!-- Theme Stylesheet -->
    <link rel="stylesheet" href="{{site.baseurl}}/assets/css/theme.css">

    <!-- Jquery on header to make sure everything works, the rest  of the scripts in footer for fast loading -->
    <script
    src="https://code.jquery.com/jquery-3.3.1.min.js"
    integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8="
    crossorigin="anonymous"></script>

    {% include tracking-header.html %}


</head>

<body class="{% if page.url == "/" %} homefirstpage {% endif %}">

    <!-- Navbar -->
    <nav id="MagicMenu" class="topnav navbar navbar-expand-lg navbar-light bg-white fixed-top">
    <div class="container">
        <a href="{{site.baseurl}}/">
            <img src="{{site.baseurl}}/assets/images/favicon/apple-touch-icon.png" style="width: 1.75rem; margin-right: 0.55rem;"/>
        </a>
        <a class="navbar-brand" href="{{site.baseurl}}/"><strong>{{site.name}}</strong></a>
        <button class="navbar-toggler collapsed" type="button" data-toggle="collapse" data-target="#navbarColor02" aria-controls="navbarColor02" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
        </button>
        <div class="navbar-collapse collapse" id="navbarColor02" style="">
            <ul class="navbar-nav mr-auto d-flex align-items-center">
               {% include menu-header.html %}
            </ul>
            <ul class="navbar-nav ml-auto d-flex align-items-center">
                {% include search-lunr.html %}
                {% include language-switcher.html %}
            </ul>
        </div>
    </div>
    </nav>

    <!-- Search Results -->
    <div id="lunrsearchresults">
        <ul class="mb-0"></ul>
    </div>

    <!-- Content -->
    <main role="main" class="site-content">
        {{ content }}
    </main>


    <!-- Scripts: popper, bootstrap, theme, lunr -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.6/umd/popper.min.js" integrity="sha384-wHAiFfRlMFy6i5SRaxvfOCifBUQy1xHdJ/yoi7FRNXMRBu5WHdZYu1hA6ZOblgut" crossorigin="anonymous"></script>

    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.2.1/js/bootstrap.min.js" integrity="sha384-B0UglyR+jN6CkvvICOB2joaf5I4l3gm9GU6Hc1og6Ls7i6U/mkkaduKaBhlAXv9k" crossorigin="anonymous"></script>

    <script src="{{site.baseurl}}/assets/js/theme.js"></script>


    <!-- Footer -->
    <footer class="bg-white border-top p-3 text-muted small">
        <div class="container">
        <div class="row align-items-center justify-content-between">
            <div>
                <span><strong>Just Jason</strong></span>
                <span>Copyright © <script>document.write(new Date().getFullYear())</script>.</span>

                <!--  Github Repo Star Btn-->
                <a class="text-dark ml-1" target="_blank" href="https://github.com/junxinzhang/junxinzhang.github.io/discussions"><i class="fab fa-github"></i> Discussions on Github</a>

            </div>
            <div>
                Made with <a target="_blank" class="text-dark font-weight-bold" href="https://www.wowthemes.net/mundana-jekyll-theme/"> Mundana Jekyll Theme </a> by <a class="text-dark" target="_blank" href="https://www.wowthemes.net">WowThemes</a>.
            </div>
        </div>
        </div>
    </footer>

    <!-- Back to Top Button -->
    <a href="#" id="backToTop" class="back-to-top" title="{{ t.misc.back_to_top | default: 'Back to Top' }}">
        <i class="fas fa-arrow-up"></i>
    </a>

    <style>
    .back-to-top {
        position: fixed;
        bottom: 30px;
        right: 30px;
        width: 45px;
        height: 45px;
        background-color: #007bff;
        color: #fff;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        text-decoration: none;
        opacity: 0;
        visibility: hidden;
        transition: all 0.3s ease;
        z-index: 1000;
        box-shadow: 0 2px 10px rgba(0,0,0,0.2);
    }
    .back-to-top:hover {
        background-color: #0056b3;
        color: #fff;
        transform: translateY(-3px);
    }
    .back-to-top.visible {
        opacity: 1;
        visibility: visible;
    }
    </style>

    <script>
    $(document).ready(function() {
        // Back to Top Button
        var backToTop = $('#backToTop');
        $(window).scroll(function() {
            if ($(this).scrollTop() > 300) {
                backToTop.addClass('visible');
            } else {
                backToTop.removeClass('visible');
            }
        });
        backToTop.click(function(e) {
            e.preventDefault();
            $('html, body').animate({scrollTop: 0}, 500);
        });

        // Lazy Loading for Images with background-image
        if ('IntersectionObserver' in window) {
            var lazyImageObserver = new IntersectionObserver(function(entries) {
                entries.forEach(function(entry) {
                    if (entry.isIntersecting) {
                        var lazyImage = entry.target;
                        var bgImage = lazyImage.getAttribute('data-bg');
                        if (bgImage) {
                            lazyImage.style.backgroundImage = 'url(' + bgImage + ')';
                            lazyImage.classList.add('lazy-loaded');
                        }
                        lazyImageObserver.unobserve(lazyImage);
                    }
                });
            }, {
                rootMargin: '100px 0px'
            });

            document.querySelectorAll('.lazy-bg').forEach(function(lazyImage) {
                lazyImageObserver.observe(lazyImage);
            });
        } else {
            // Fallback for browsers without IntersectionObserver
            document.querySelectorAll('.lazy-bg').forEach(function(lazyImage) {
                var bgImage = lazyImage.getAttribute('data-bg');
                if (bgImage) {
                    lazyImage.style.backgroundImage = 'url(' + bgImage + ')';
                }
            });
        }
    });
    </script>

    <style>
    .lazy-bg {
        background-color: #f0f0f0;
        transition: opacity 0.3s ease;
    }
    .lazy-bg.lazy-loaded {
        opacity: 1;
    }
    </style>

    {% include tracking-footer.html %}

</body>

</html>
